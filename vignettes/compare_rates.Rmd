---
title: "compare_rates"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{compare_rates}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(uxr)
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyr))
```


```{r}
design = c("A","B")
complete = c(3, 1)
incomplete = c(1, 0)
data <- data.frame(design, complete, incomplete)
data <- data %>% pivot_longer(!design, names_to = "rate", values_to = "n") %>% tidyr::uncount(n)
```


Confidence interval for difference between proportions (Sauro & Lewis, 2016; Agresti & Caffo, 2000)

```{r}
data |> 
  test_n_1_two_prop(design, rate, "complete", 1.96) 
```
If expected count less than 1, use fisher's test, else use test_n_minus_1_two_prop

```{r}
chisq.test(data$design, data$rate)$expected |> data.frame()
```

